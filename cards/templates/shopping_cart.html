{% extends 'base.html' %}
{% block child %}
{% load filters %}
{% load render_table from django_tables2 %}

<style>
.likeabutton {
    text-decoration: none; font: menu;
    display: inline-block; padding: 2px 8px;
    background: ButtonFace; color: ButtonText;
    border-style: solid; border-width: 2px;
    border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
}
.likeabutton:active {
    border-color: ButtonShadow ButtonHighlight ButtonHighlight ButtonShadow;
}
</style>
    <div class="container" style="min-height: 640px">
        <div class="row">
            <div class="col-lg-6">
                <h3>
                </h3>
            </div>
        </div>
        
        <form action="bulk/add_cart/" method="POST">
            <p>
              <div class="row" >
              
<table border="1px" cellpadding="10px" cellspacing="10px" align="center" id="cartTable">

{% for cart in cart_items %}
<tr id="tr_{{forloop.counter }}">
	
	{% for items in cart %}
	    <td>
	    		<b>Item  {{forloop.parentloop.counter}}</b> <br><img src="{{ STATIC_URL }}images/{{ items.card_flavour_image_file }}" alt="{{ items.card_type }}" height="82" width="142">
	    		   <input type="hidden" id="ctype_{{forloop.parentloop.counter}}" name="ctype" value="{{ items.card_type }}">  
  					<input type="hidden" id="batchid_{{forloop.parentloop.counter}}" name="batchid" value="{{ items.activate_card_batch_id }}"> 
	    </td>
	    <td>
	    		{{ items.card_flavour }}
	    		<input type="hidden" id="cflavour_{{forloop.parentloop.counter }}" name="cflavour" value="{{ items.card_flavour }}">
	    </td>
	    <td>
	    		Quantity : <a title="{% for a in card_numbers %}{% for cn in a %}{% if items.card_flavour ==  cn.card_flavour %}Card Number: {{ cn.card_number }} {% endif %} {% endfor %}{% endfor %}" href='javascript:void(0);)'>{{ items.quantity }} </a>
	    </td>
	    <td>
	   		{{ items.total_amount }}
	    </td>
	    <td>
          	<a class="deleteLink" href="#" onclick="javascript:removeCartItems({{ forloop.parentloop.counter }})"> Remove </a> | <a href="#"> Update </a>
		 </td> 
  {% endfor %}
 </tr>
{% endfor %}
</table>
</div>
            </p>
               	{% if request.session.cartcount != 0  %}                
                	 <p>
                <div class="row">
                    <div class="col-lg-8">
                        <div style="float:right">                             
                           
                            <a href="../purchase/" class="likeabutton">Continue Shopping</a>
                            <a href="#l" class="likeabutton" >Proceed To Checkout</a>
                            
                        </div>
                    </div>
                </div>
               </p>
		{% else %}
		    <p>
                <div class="row">
                    <div class="col-lg-8">
                        <div style="float:right">                             
                            <span >You have no Items in Cart... </span>
                            <a href="../purchase/" class="likeabutton">Continue Shopping</a>
                            
                            
                        </div>
                    </div>
                </div>
               </p>
		
	       {% endif %}  
               </form>        
    </div>
    
<script src="{{ STATIC_URL }}js/vendor/jquery/1.10.1/jquery.min.js"></script>
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<script type="text/javascript">

function removeCartItems(counter) {

        var ctype = $( "#ctype_"+counter ).val();
        var batchid = $( "#batchid_"+counter ).val();
        var cflavour = $( "#cflavour_"+counter ).val();
        
        //alert(ctype);
        //alert(batchid);
        //alert(cflavour);
        $.ajax({
        	 type: "POST",
       	 url: "../del_cart/",
        	 data: {
            batchid: batchid,
            ctype : ctype,
            cflavour : cflavour,
         },
       	success: function(data) {
       		$( "#tr_"+counter ).remove();
       			window.location.reload();
            //alert("Item Deleted Successfully");
        	},
        	error: function(xhr, textStatus, errorThrown) {
            alert("Please report this error: "+errorThrown+xhr.status+xhr.responseText);
        	}
    	   });
	  		 
}

/*
function continueShop(){
	$.ajax({
	
        	type: "POST",
       	url: "../continue_cart/",
        	data: {
          continue_shop = 'true'
         },
       	success: function(data) {
         
        	},
        	error: function(xhr, textStatus, errorThrown) {
            alert("Please report this error: "+errorThrown+xhr.status+xhr.responseText);
        	}
  }); 
}
*/

</script>
{% endblock %}

